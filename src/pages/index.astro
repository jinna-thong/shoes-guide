---
/**
 * Homepage - English
 * E6-S04: SEO Enhancement with JSON-LD Structured Data
 */

import { getAllProducts } from '../lib/db';
import Layout from '../layouts/Layout.astro';

const products = await getAllProducts();
const featuredProducts = products.slice(0, 6);

// Site configuration
const siteUrl = 'https://shoes.guide';

// WebSite JSON-LD for search engine features
const websiteJsonLd = {
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "LENS - Running Shoe Comparison",
  "alternateName": "LENS",
  "url": siteUrl,
  "description": "Compare running shoes from top brands with expert reviews and detailed specifications.",
  "inLanguage": ["en", "th"],
  "potentialAction": {
    "@type": "SearchAction",
    "target": {
      "@type": "EntryPoint",
      "urlTemplate": `${siteUrl}/products/?q={search_term_string}`
    },
    "query-input": "required name=search_term_string"
  }
};

// Organization JSON-LD for brand knowledge
const organizationJsonLd = {
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "LENS",
  "url": siteUrl,
  "logo": `${siteUrl}/favicon.svg`,
  "description": "Running shoe comparison platform with expert reviews and detailed specifications.",
  "sameAs": []
};
---

<Layout title="Home" description="Compare running shoes from top brands with expert reviews">
  <!-- JSON-LD Structured Data -->
  <Fragment slot="head">
    <script type="application/ld+json" set:html={JSON.stringify(websiteJsonLd)} />
    <script type="application/ld+json" set:html={JSON.stringify(organizationJsonLd)} />
  </Fragment>
  <main>
    <!-- Hero Section -->
    <section class="bg-gradient-to-r from-blue-600 to-blue-800 text-white py-20">
      <div class="container mx-auto px-4 text-center">
        <h1 class="text-5xl font-bold mb-4">Find Your Perfect Running Shoe</h1>
        <p class="text-xl mb-8 max-w-2xl mx-auto">
          Compare 25+ flagship running shoes from top brands with detailed specifications and expert reviews
        </p>
        <a href="/products" class="inline-block bg-white text-blue-600 px-8 py-3 rounded-lg font-semibold hover:bg-gray-100 transition">
          Browse All Products
        </a>
      </div>
    </section>

    <!-- Featured Products -->
    <section class="py-16">
      <div class="container mx-auto px-4">
        <h2 class="text-3xl font-bold mb-8">Featured Products</h2>
        <div class="grid md:grid-cols-3 gap-8">
          {featuredProducts.map((product) => (
            <a
              href={`/products/${product.slug}`}
              class="block bg-white border rounded-lg overflow-hidden hover:shadow-lg transition"
            >
              <div class="bg-gray-100 p-8 flex items-center justify-center h-64">
                {product.primary_image_url ? (
                  <img
                    src={product.primary_image_url}
                    alt={product.model_name}
                    class="max-w-full max-h-full object-contain"
                    loading="lazy"
                    decoding="async"
                  />
                ) : (
                  <div class="text-gray-400">
                    <svg class="w-24 h-24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                    </svg>
                  </div>
                )}
              </div>
              <div class="p-6">
                <p class="text-sm text-gray-500 uppercase tracking-wide">{product.brand}</p>
                <h3 class="text-lg font-semibold mt-1 mb-2">{product.model_name}</h3>
                <p class="text-gray-600 text-sm">
                  {product.price_range_min && product.price_range_max
                    ? `${product.price_range_min.toLocaleString()} - ${product.price_range_max.toLocaleString()} THB`
                    : 'Price unavailable'}
                </p>
              </div>
            </a>
          ))}
        </div>
      </div>
    </section>

    <!-- Brands -->
    <section class="bg-gray-50 py-16">
      <div class="container mx-auto px-4">
        <h2 class="text-3xl font-bold mb-8 text-center">Top Brands</h2>
        <div class="grid grid-cols-2 md:grid-cols-6 gap-4">
          {['Nike', 'Adidas', 'ASICS', 'New Balance', 'Hoka', 'Mizuno'].map((brand) => (
            <a
              href={`/brands/${brand.toLowerCase().replace(' ', '-')}`}
              class="bg-white border rounded-lg p-6 text-center hover:shadow-md transition"
            >
              <p class="font-semibold">{brand}</p>
            </a>
          ))}
        </div>
      </div>
    </section>
  </main>
</Layout>
